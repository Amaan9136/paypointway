<!DOCTYPE html>
<html>

<head>
  <title>Transaction Records</title>
  <link rel="icon" href="img/LOGO.png" type="png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="HandheldFriendly" content="true" />
  <meta name="MobileOptimized" content="320" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="css/mainpage.css" rel="stylesheet" />
  <style>
    body {
      background-image: url('img/bgimg.png');
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;
      height: 100vh;
      width: 100vw;
      margin: 0;
      padding: 0;
    }

    .text-black {
      text-align: start;
      color: black;
    }

    hr {
      background-color: .000000;
      margin: 1px -5px;
      padding: 2px;
    }

    .alert.no-content {
      display: none;
    }

    .alert,
    .alert-message {
      margin: 0;
      padding: 0;
      padding-bottom: 2px;
      font-size: 18px;
      /* Adjust the font size as per your preference */
      font-weight: bold;
    }

    .alert-message:empty {
      display: none;
    }

    br {
      margin: 0;
    }

    .my-btn {
      font-size: 16px;
    }

    .card-title {
      font-size: 18px;
      font-family: 'Roboto', 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
    }

    .card-title2 {
      font-size: 26px;
      font-family:    'Roboto', 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
    }

    .card-text {
      font-size: 18px;
    }

    /* Media query for mobile devices */
@media (max-width: 768px) {
    .container2 {
        margin: 2px;
        margin-top: 5px;
        padding: 1px;
        max-width: auto; /* Adjust the maximum width as needed */
    }
}
  </style>
</head>

<body>
  <div class="wrapper">
    <div class="content">


      <div class="container container2">
        <h5 class="card-title card-title2 text-white text-center">Transaction Records</h5>
        <p class="card-text text-center text-white ">
          Track your Financial Footprints.
        </p>
      </div>

      <!-- Select Pannel -->
      <div class="container2 container card-header">

        <!-- buttons -->
        <div class="d-flex justify-content-between">
          <div>
            <a class="btn btn-underline my-btn btn-primary active " id="item1-btn">Withdraw</a>
          </div>
          <div>
            <a class="btn btn-underline my-btn btn-primary" id="item2-btn">Recharge</a>
          </div>
          <div>
            <a class="btn btn-underline my-btn btn-primary" id="item3-btn">All Records</a>
          </div>
        </div>

        <!-- Pannel Lists -->
        <div class="row mt-4" id="card-section">

          <div class="col-md-4" id="item1-cards">
            <!-- item1 -->
            <div id="withdraw-container"></div>
          </div>

          <div class="col-md-4" id="item2-cards" style="display: none;">
            <!-- item2 -->
            <div id="recharge-container"></div>
          </div>

          <div class="col-md-4" id="item3-cards" style="display: none;">
            <!-- item3 -->
            <div id="all-container"></div>
          </div>

        </div>

      </div>

    </div>
    <!-- footer -->
    <footer class="footer">
      <div class="container2">
        <div class="row">
          <div class="col-md-12">
            <div class="btn-group" role="group">
              <button class="btn btn-primary btn-icon btn-underline" id="homeButton"
                onclick="location.href='mainpage.html'">
                <img src="img/home.png" alt="Home" class="btn-icon-image" />
                <span class="btn-text"><br />Home</span>
              </button>
              <button class="btn btn-primary btn-icon btn-underline" id="downloadButton"
                onclick="location.href='download.html'">
                <img src="img/download.png" alt="Download" class="btn-icon-image" />
                <span class="btn-text"><br />Download</span>
              </button>
              <button class="btn btn-primary btn-icon btn-underline" id="inviteButton"
                onclick="location.href='invite.html'">
                <img src="img/invite.png" alt="Invite" class="btn-icon-image" />
                <span class="btn-text"><br />Invite</span>
              </button>
              <button class="btn btn-primary btn-icon btn-underline" id="profileButton"
                onclick="location.href='profile.html'">
                <img src="img/my.png" alt="Profile" class="btn-icon-image" />
                <span class="btn-text"><br />Profile</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <!-- footer -->
  <script>
    function setActiveButton() {
      // Get the current page URL or any other identifier you're using
      var currentPage = window.location.href;

      // Get the buttons
      var homeButton = document.getElementById("homeButton");
      var downloadButton = document.getElementById("downloadButton");
      var inviteButton = document.getElementById("inviteButton");
      var profileButton = document.getElementById("profileButton");

      // Remove active class from all buttons
      homeButton.classList.remove("active");
      downloadButton.classList.remove("active");
      inviteButton.classList.remove("active");
      profileButton.classList.remove("active");

      // Set active class for the corresponding button based on the current page
      if (currentPage.includes("mainpage.html")) {
        homeButton.classList.add("active");
      } else if (currentPage.includes("download.html")) {
        downloadButton.classList.add("active");
      } else if (currentPage.includes("invite.html")) {
        inviteButton.classList.add("active");
      } else if (currentPage.includes("transactionRecords.html")) {
        profileButton.classList.add("active");
      }
    }

    // Call the setActiveButton function when the page loads
    window.onload = setActiveButton;
  </script>

  <!-- income -->
  <script>
    // JavaScript code to handle button clicks and show/hide card sections
    const item1Btn = document.getElementById('item1-btn');
    const item2Btn = document.getElementById('item2-btn');
    const item3Btn = document.getElementById('item3-btn');

    const item1Cards = document.getElementById('item1-cards');
    const item2Cards = document.getElementById('item2-cards');
    const item3Cards = document.getElementById('item3-cards');

    item1Btn.addEventListener('click', () => {
      item1Btn.classList.add('active');

      item1Cards.style.display = 'block';
      item2Cards.style.display = 'none';
      item3Cards.style.display = 'none';
    });

    item2Btn.addEventListener('click', () => {
      item2Btn.classList.add('active');

      item1Cards.style.display = 'none';
      item2Cards.style.display = 'block';
      item3Cards.style.display = 'none';
    });

    item3Btn.addEventListener('click', () => {
      item3Btn.classList.add('active');

      item1Cards.style.display = 'none';
      item2Cards.style.display = 'none';
      item3Cards.style.display = 'block';
    });
  </script>

  <!-- withdrawjs -->
  <script>
    fetch('php/transactionRecords.php')
      .then(response => response.json())
      .then(data => {
        // Sort the data in descending order based on ID
        data.sort((a, b) => b.withdrawId - a.withdrawId);
  
        const withdrawContainer = document.getElementById('withdraw-container');
  
        data.forEach(item => {
          if (!item.withdrawAmount) {
            return; // Skip this record if withdrawAmount is null or undefined
          }
  
          const withdrawAmount = item.withdrawAmount;
          const bankName = item.bankName;
          const status = item.status;
          const createdAtDate = item.withdrawDate;
          const createdAtTime = item.withdrawTime;
          const withdrawId = item.withdrawId; // Add this line to retrieve the ID
  
          // Create card element
          const cardElement = document.createElement('div');
          cardElement.className = 'card-body card-text text-black';
  
          // Create and populate card title element (application number)
          const cardTitleElement = document.createElement('h5');
          cardTitleElement.className = 'card-title';
          cardTitleElement.innerHTML = `Withdraw Application: ${withdrawId}<hr>`;
          cardElement.appendChild(cardTitleElement);
  
          // Create and populate withdraw amount element
          const withdrawAmountElement = document.createElement('p');
          withdrawAmountElement.className = 'withdraw-amount';
          withdrawAmountElement.textContent = `Withdraw Amount: â‚¹${withdrawAmount}`;
          cardElement.appendChild(withdrawAmountElement);
  
          // Create and populate bank name element
          const bankNameElement = document.createElement('p');
          bankNameElement.className = 'bank-name';
          bankNameElement.textContent = `To Bank: ${bankName}`;
          cardElement.appendChild(bankNameElement);
  
          // Create and populate created at time element
          const createdAtTimeElement = document.createElement('p');
          createdAtTimeElement.className = 'created_at_time';
          createdAtTimeElement.textContent = `Withdraw Time: ${createdAtTime}`;
          cardElement.appendChild(createdAtTimeElement);
  
          // Create and populate created at date element
          const createdAtDateElement = document.createElement('p');
          createdAtDateElement.className = 'created_at_date';
          createdAtDateElement.textContent = `Withdraw Date: ${createdAtDate}`;
          cardElement.appendChild(createdAtDateElement);
  
          // Create and populate status element
          const statusElement = document.createElement('p');
          statusElement.className = 'status';
          statusElement.textContent = `Withdraw Status: ${status}`;
  
          setStatusClass(status, statusElement);
  
          cardElement.appendChild(statusElement);
  
          // Append card element to the withdraw container
          withdrawContainer.appendChild(cardElement);
        });
      })
      .catch(error => {
        console.error('Error:', error);
      });
  
    function setStatusClass(status, element) {
      if (status === 'Success') {
        element.classList.add('alert', 'alert-success');
      } else if (status === 'Rejected') {
        element.classList.add('alert', 'alert-danger');
      } else if (status === 'Pending') {
        element.classList.add('alert', 'alert-warning');
      }
    }
  </script>
  

  <!-- rechargejs -->
  <script>
    fetch('php/transactionRecords.php')
      .then(response => response.json())
      .then(data => {
        // Sort the data in descending order based on rechargeId
        data.sort((a, b) => b.rechargeId - a.rechargeId);
  
        const rechargeContainer = document.getElementById('recharge-container');
  
        data.forEach(item => {
          if (!item.rechargeAmount) {
            return; // Skip this record if rechargeAmount is null or undefined
          }
  
          const rechargeAmount = item.rechargeAmount;
          const utrNumber = item.utrNumber;
          const status = item.status;
          const createdAtDate = item.rechargeDate;
          const createdAtTime = item.rechargeTime;
          const rechargeId = item.rechargeId; // Replace 'id' with 'rechargeId'
  
          // Create card element
          const cardElement = document.createElement('div');
          cardElement.className = 'card-body card-text text-black';
  
          // Create and populate card title element (application number)
          const cardTitleElement = document.createElement('h5');
          cardTitleElement.className = 'card-title';
          cardTitleElement.innerHTML = `Recharge Application: ${rechargeId}<hr>`;
          cardElement.appendChild(cardTitleElement);
  
          // Create and populate recharge amount element
          const rechargeAmountElement = document.createElement('p');
          rechargeAmountElement.className = 'recharge-amount';
          rechargeAmountElement.textContent = `Recharge Amount: â‚¹${rechargeAmount}`;
          cardElement.appendChild(rechargeAmountElement);
  
          // Create and populate UTR number element
          const utrNumberElement = document.createElement('p');
          utrNumberElement.className = 'utr-number';
          utrNumberElement.textContent = `UTR Number: ${utrNumber}`;
          cardElement.appendChild(utrNumberElement);
  
          // Create and populate created at time element
          const createdAtTimeElement = document.createElement('p');
          createdAtTimeElement.className = 'created_at_time';
          createdAtTimeElement.textContent = `Recharge Time: ${createdAtTime}`;
          cardElement.appendChild(createdAtTimeElement);
  
          // Create and populate created at date element
          const createdAtDateElement = document.createElement('p');
          createdAtDateElement.className = 'created_at_date';
          createdAtDateElement.textContent = `Recharge Date: ${createdAtDate}`;
          cardElement.appendChild(createdAtDateElement);
  
          // Create and populate status element
          const statusElement = document.createElement('p');
          statusElement.className = 'status';
          statusElement.textContent = `Recharge Status: ${status}`;
  
          setStatusClass(status, statusElement);
  
          cardElement.appendChild(statusElement);
  
          // Append card element to the recharge container
          rechargeContainer.appendChild(cardElement);
        });
      })
      .catch(error => {
        console.error('Error:', error);
      });
  
    function setStatusClass(status, element) {
      if (status === 'Success') {
        element.classList.add('alert', 'alert-success');
      } else if (status === 'Rejected') {
        element.classList.add('alert', 'alert-danger');
      } else if (status === 'Pending') {
        element.classList.add('alert', 'alert-warning');
      }
    }
  </script>
  

  <!-- allrecordjs -->
  <script>
    fetch('php/transactionRecords.php')
      .then(response => response.json())
      .then(data => {
        const allRecords = [...data];

        // Combine withdraw and recharge records
        const combinedRecords = allRecords.reduce((combined, record) => {
          if (record.withdrawTime) {
            combined.push({ ...record, time: record.withdrawTime, type: 'Withdraw' });
          }
          if (record.rechargeTime) {
            combined.push({ ...record, time: record.rechargeTime, type: 'Recharge' });
          }
          return combined;
        }, []);

        // Sort the combined records based on time in ascending order
        combinedRecords.sort((a, b) => new Date(a.time) - new Date(b.time));

        const allContainer = document.getElementById('all-container');

        combinedRecords.forEach(record => {
          const withdrawId = record.withdrawId;
          const rechargeId = record.rechargeId;
          const id = withdrawId || rechargeId; // Use withdraw ID if available, otherwise use recharge ID

          if (!id) {
            return;
          }

          const withdrawAmount = record.withdrawAmount;
          const bankName = record.bankName;
          const rechargeAmount = record.rechargeAmount;
          const utrNumber = record.utrNumber;
          const withdrawStatus = record.withdrawStatus || record.status; // Use withdraw status if available, otherwise use status
          const rechargeStatus = record.rechargeStatus || record.status; // Use recharge status if available, otherwise use status
          const withdrawDate = record.withdrawDate;
          const withdrawTime = record.withdrawTime;
          const rechargeDate = record.rechargeDate;
          const rechargeTime = record.rechargeTime;
          const type = record.type;

          // Create card element
          const cardElement = document.createElement('div');
          cardElement.className = 'card-body card-text text-black';

          // Create and populate card title element (application number)
          const cardTitleElement = document.createElement('h5');
          cardTitleElement.className = 'card-title';
          cardTitleElement.innerHTML = `${type} Application: ${id}<hr>`;
          cardElement.appendChild(cardTitleElement);

          // Check if it's a withdraw record
          if (withdrawId) {
            // Create and populate withdraw amount element
            const withdrawAmountElement = document.createElement('p');
            withdrawAmountElement.className = 'withdraw-amount';
            withdrawAmountElement.textContent = `Withdraw Amount: â‚¹${withdrawAmount}`;
            cardElement.appendChild(withdrawAmountElement);

            // Create and populate bank name element
            const bankNameElement = document.createElement('p');
            bankNameElement.className = 'bank-name';
            bankNameElement.textContent = `To Bank: ${bankName}`;
            cardElement.appendChild(bankNameElement);

            // Create and populate created at time element
            const createdAtTimeElement = document.createElement('p');
            createdAtTimeElement.className = 'created_at_time';
            createdAtTimeElement.textContent = `Withdraw Time: ${withdrawTime}`;
            cardElement.appendChild(createdAtTimeElement);

            // Create and populate created at date element
            const createdAtDateElement = document.createElement('p');
            createdAtDateElement.className = 'created_at_date';
            createdAtDateElement.textContent = `Withdraw Date: ${withdrawDate}`;
            cardElement.appendChild(createdAtDateElement);

            // Create and populate status element
            const statusElement = document.createElement('p');
            statusElement.className = 'status';
            statusElement.textContent = `Withdraw Status: ${withdrawStatus}`;

            setStatusClass(withdrawStatus, statusElement);

            cardElement.appendChild(statusElement);
          }

          // Check if it's a recharge
          if (rechargeId) {
            // Create and populate recharge amount element
            const rechargeAmountElement = document.createElement('p');
            rechargeAmountElement.className = 'recharge-amount';
            rechargeAmountElement.textContent = `Recharge Amount: â‚¹${rechargeAmount}`;
            cardElement.appendChild(rechargeAmountElement);

            // Create and populate UTR number element
            const utrNumberElement = document.createElement('p');
            utrNumberElement.className = 'utr-number';
            utrNumberElement.textContent = `UTR Number: ${utrNumber}`;
            cardElement.appendChild(utrNumberElement);

            // Create and populate created at time element
            const createdAtTimeElement = document.createElement('p');
            createdAtTimeElement.className = 'created_at_time';
            createdAtTimeElement.textContent = `Recharge Time: ${rechargeTime}`;
            cardElement.appendChild(createdAtTimeElement);

            // Create and populate created at date element
            const createdAtDateElement = document.createElement('p');
            createdAtDateElement.className = 'created_at_date';
            createdAtDateElement.textContent = `Recharge Date: ${rechargeDate}`;
            cardElement.appendChild(createdAtDateElement);

            // Create and populate status element
            const statusElement = document.createElement('p');
            statusElement.className = 'status';
            statusElement.textContent = `Recharge Status: ${rechargeStatus}`;

            setStatusClass(rechargeStatus, statusElement);

            cardElement.appendChild(statusElement);
          }

          // Append card element to the all container
          allContainer.appendChild(cardElement);
        });
      })
      .catch(error => {
        console.error('Error:', error);
      });

    function setStatusClass(status, element) {
      if (status === 'Success') {
        element.classList.add('alert', 'alert-success');
      } else if (status === 'Rejected') {
        element.classList.add('alert', 'alert-danger');
      } else if (status === 'Pending') {
        element.classList.add('alert', 'alert-warning');
      }
    }
  </script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function () {
      // Add click event handlers to the buttons
      $("#item1-btn").click(function () {
        // Remove active class from all buttons
        $(".my-btn").removeClass("active");
        // Add active class to the clicked button
        $(this).addClass("active ");

        // Add your code for the "Withdraw" functionality here
      });

      $("#item2-btn").click(function () {
        // Remove active class from all buttons
        $(".my-btn").removeClass("active");
        // Add active class to the clicked button
        $(this).addClass("active");

        // Add your code for the "Recharge" functionality here
      });

      $("#item3-btn").click(function () {
        // Remove active class from all buttons
        $(".my-btn").removeClass("active");
        // Add active class to the clicked button
        $(this).addClass("active");

        // Add your code for the "All Records" functionality here
      });
    });
  </script>

</body>

</html>